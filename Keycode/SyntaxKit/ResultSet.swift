//
//  ResultSet.swift
//  SyntaxKit
//
//  Stores a set of results generated by the parser. 
//
//  Created by Sam Soffes on 10/11/14.
//  Copyright Â© 2014-2015 Sam Soffes. All rights reserved.
//

import Foundation

class ResultSet {
    
    // MARK: - Properties
    
    var results: [Result]   { return _results }
    /// Guaranteed to be larger or equal to the union of all the ranges 
    /// associated with the contained results.
    var range: NSRange      { return _range }
    
    private var _results = [Result]()
    private var _range: NSRange
    
    
    // MARK: - Initializers
    
    init(startingRange range: NSRange) {
        _range = range
    }
    
    
    // MARK: - Adding
    
    func extendWithRange(_ range: NSRange) {
        _range = NSUnionRange(self.range, range)
    }
    
    func addResult(_ result: Result) {
        extendWithRange(result.range)
        _results.append(result)
    }
    
    func addResults(_ resultSet: ResultSet) {
        extendWithRange(resultSet.range)
        for result in resultSet.results {
            _results.append(result)
        }
    }
}
